<!DOCTYPE html>
<html>
    <head>
        <title>Web Design Hell</title>
        <link rel="stylesheet" src="template.css"/>
        <script src="imageMapResizer.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script type="text/javascript" src="jquery.maphilight.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>            
            /*#minimapCont::-webkit-scrollbar {
                width: 0px;  /* remove scrollbar space
                background: transparent;  /* optional: just make scrollbar invisible
            }*/
            #infocont > a {
                display:block;position:absolute;left:0;width:100%;
            }
        </style>
        <script>
            $(function() {
                  $('.map').maphilight();
            });
            
            var loadPage = function(pageName) {
                $("#viewer").attr("src", pageName);
            }
        </script>
    </head>
    <!--scrolling div must handle itself-->
    <body style="position: fixed;display: block;top:0;left:0;width:100%;height:100%;overflow: hidden;margin:0;padding:0;">
        <div id="windowblock" style="position:fixed;left:0;top:0;width:100%;height:100%;z-index:999;background-color: #3a3a3a;">
            <div style="position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);text-align:center;font-family:Lato,Arial,sans-serif;width:100%;max-width:700px;">
                <span style="color:white;font-size: 30pt;font-weight:bold">Your<span id="windowsize" style="color:lightgray;display:block;font-size:40pt;"></span>window into Hell is too small!</span>
            </div>
        </div>
        <div style="display: flex;justify-content: flex-start;align-items: stretch; position: absolute;width:100%;height:100%;top:0;left:0;">
            <div id="minimapCont" style="width:300px;min-width:300px;order: 0;flex-grow:0;position:relative">
                <div style="width:100%;height:100px;background-color:black;color:white;position: relative">
                    <div style="position: absolute;top:50%;left:50%;transform: translateX(-50%) translateY(-50%);font-family:Lato,Arial,sans-serif;font-size:24px;font-weight:bold">Navigation</div>
                </div>
                <div style="overflow-x:hidden;overflow-y: scroll;position: absolute;bottom:0;top:100px;width:100%;background-color:#434343">
                    <div id="infocont" style="width:100%;margin-bottom:-5px;position:relative">
                        <img class="map" src="minimap.svg" style="width:100%;margin-bottom:-5px;" usemap="#minimap">
                        <a style="top:0;height:9.5%;" href="#" onclick="loadPage('dark forest/index.html');return false;" title="Dark Forest"></a>
                        <a style="top:9.5%;height:10.1%;" href="#" onclick="loadPage('i/index.html');return false;" title="Circle I"></a>
                        <a style="top:19.6%;height:10.1%;" href="#" onclick="loadPage('ii/index.html');return false;" title="Circle II"></a>
                        <a style="top:29.7%;height:10.05%;" href="#" onclick="loadPage('iii/index.html');return false;" title="Circle III"></a>
                        <a style="top:39.75%;height:10.04%;" href="#" onclick="loadPage('iv/index.html');return false;" title="Circle IV"></a>
                        <a style="top:49.79%;height:10.04%;" href="#" onclick="loadPage('v/index.html');return false;" title="Circle V"></a>
                        <a style="top:59.83%;height:10%;" href="#" onclick="loadPage('vi/index.html');return false;" title="Circle VI"></a>
                        <a style="top:69.83%;height:10%;" href="#" onclick="loadPage('vii/index.html');return false;" title="Circle VII"></a>
                        <a style="top:79.83%;height:10.05%;" href="#" onclick="loadPage('viii/index.html');return false;" title="Circle VIII"></a>
                        <a style="top:89.88%;height:10%;" href="#" onclick="loadPage('ix/index.html');return false;" title="Circle IX"></a>
                    </div>
                    <map name="minimap">
                        <!--<area shape="rect" coords="0,0,314,147" alt="Forest" onclick="loadPage('dark forest/index.html')" title="Dark Forest">
                        <area shape="rect" coords="0,0,314,295" alt="I" onclick="loadPage('i/index.html')" title="Circle I">
                        <area shape="rect" coords="0,0,314,465" alt="II" onclick="loadPage('ii/index.html')" title="Circle II">
                        <area shape="rect" coords="0,0,314,621" alt="III" onclick="loadPage('iii/index.html')" title="Circle III">
                        <area shape="rect" coords="0,0,314,778" alt="IV" onclick="loadPage('iv/index.html')" title="Circle IV">
                        <area shape="rect" coords="0,0,314,935" alt="V" onclick="loadPage('v/index.html')" title="Circle V">
                        <area shape="rect" coords="0,0,314,1093" alt="VI" onclick="loadPage('vi/index.html')" title="Circle VI">
                        <area shape="rect" coords="0,0,314,1250" alt="VII" onclick="loadPage('vii/index.html')" title="Circle VII">
                        <area shape="rect" coords="0,0,314,1407" alt="VIII" onclick="loadPage('viii/index.html')" title="Circle VIII">
                        <area shape="rect" coords="0,0,314,1565" alt="IX" onclick="loadPage('ix/index.html')" title="Circle IX">-->
                    </map>
                </div>
            </div>
            <iframe id="viewer" src="dark forest/index.html" style="background-color:#434343;order:1;flex-grow:99"></iframe>
            <script>
                var boundFinder = function() {
                    if($(window).width() < 850 || $(window).height() < 500) {
                        let bounds = $(window).width() + "x" + $(window).height();
                        $("#windowsize").text(bounds);
                        $("#windowblock").css("display", "block");
                    }
                    else $("#windowblock").css("display", "none");
                }
                
                navigator.sayswho = (function(){
                    var ua= navigator.userAgent, tem,
                    M= ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
                    if(/trident/i.test(M[1])){
                        tem=  /\brv[ :]+(\d+)/g.exec(ua) || [];
                        return 'IE '+(tem[1] || '');
                    }
                    if(M[1]=== 'Chrome'){
                        tem= ua.match(/\b(OPR|Edge)\/(\d+)/);
                        if(tem!= null) return tem.slice(1).join(' ').replace('OPR', 'Opera');
                    }
                    M= M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
                    if((tem= ua.match(/version\/(\d+)/i))!= null) M.splice(1, 1, tem[1]);
                    return M.join(' ');
                })();
                
                $(document).ready(function() {
                    console.log(navigator.sayswho);
                    $("#viewer").load(function() {
                        
                        // load content of document in iframe
                        // works, but scripts can only close windows that were opened by it
                        var innerDoc = document.getElementById("viewer").contentDocument || document.getElementById("viewer").contentWindow.document;
                        
                        if(!innerDoc.getElementById("yes")) return;
                        
                        innerDoc.getElementById("yes").addEventListener("click",function() {
                            // removes everything
                            $("body").remove();
                            location.reload();
                            // called from iframe which can't close current window since it was opened by window itself
                            //close();
                        });
                    });
                    
                    // phase out for now
                    /*if(navigator.sayswho.indexOf("Chrome")!=-1) imageMapResize();
                    else {
                        $("map[name=minimap]").html("<area shape='rect' coords='0,0,314,147' alt='Forest' onclick='loadPage('dark forest/index.html')' title='Dark Forest'> <area shape='rect' coords='0,0,314,295' alt='I' onclick='loadPage('i/index.html')' title='Circle I'> <area shape='rect' coords='0,0,314,465' alt='II' onclick='loadPage('ii/index.html')' title='Circle II'> <area shape='rect' coords='0,0,314,621' alt='III' onclick='loadPage('iii/index.html')' title='Circle III'> <area shape='rect' coords='0,0,314,778' alt='IV' onclick='loadPage('iv/index.html')' title='Circle IV'> <area shape='rect' coords='0,0,314,935' alt='V' onclick='loadPage('v/index.html')' title='Circle V'> <area shape='rect' coords='0,0,314,1093' alt='VI' onclick='loadPage('vi/index.html')' title='Circle VI'> <area shape='rect' coords='0,0,314,1250' alt='VII' onclick='loadPage('vii/index.html')' title='Circle VII'> <area shape='rect' coords='0,0,314,1407' alt='VIII' onclick='loadPage('viii/index.html')' title='Circle VIII'> <area shape='rect' coords='0,0,314,1565' alt='IX' onclick='loadPage('ix/index.html')' title='Circle IX'>");
                    }*/
                });
                
                $(window).on("resize", boundFinder);
                $(document).on("ready", boundFinder);
                
                
            
            </script>
        </div>
    </body>
</html>